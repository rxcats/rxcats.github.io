"use strict";(self["webpackChunkchat_service_client"]=self["webpackChunkchat_service_client"]||[]).push([[934],{7108:(o,e,t)=>{t.d(e,{QA:()=>r,L_:()=>n,FJ:()=>i});var s=t(8202);const n={lobby:"로비",room:"방"},i={notConnected:{message:"서버와 연결 중입니다. 다시 시도해 주세요.",spinner:!0,position:"top",timeout:300},lostConnection:{message:"서버와 연결이 종료되었습니다. 로그인 화면으로 이동합니다.",spinner:!0,position:"top",timeout:300},lostLoginInfo:{message:"로그인 정보가 없습니다. 로그인 화면으로 이동합니다.",spinner:!0,position:"top",timeout:300}};function a(o){return s.ou.fromISO(o).toFormat("HH:mm")}class l{joinMessage(o,e,t){return{color:"#000000",message:`${o.username}님이 ${t}에 참여했습니다.`,now:a(e)}}leaveMessage(o,e,t){return{color:"#000000",message:`${o.username}님이 ${t}에서 나갔습니다.`,now:a(e)}}chatMessage(o,e,t){return{color:o.userColor,message:`${o.username}: ${e}`,now:a(t)}}disconnected(o,e){return{color:"#000000",message:`${o.username}님의 연결이 종료되었습니다.`,now:a(e)}}}const r=new l},5934:(o,e,t)=>{t.r(e),t.d(e,{default:()=>x});var s=t(3673),n=t(2323);const i=o=>((0,s.dD)("data-v-a5b6a462"),o=o(),(0,s.Cn)(),o),a={class:"q-pa-md"},l={class:"row justify-start"},r={class:"col-all"},u={class:"dialog-width"},d=i((()=>(0,s._)("div",{class:"text-h6 col text-center"},"방 만들기",-1))),c={class:"row justify-start"},m={class:"col-all"},h={class:"row justify-start"},b={class:"col-3"},p={class:"col"},w=(0,s.Uk)("채팅 목록"),g={class:"col-3"};function f(o,e,t,i,f,y){const $=(0,s.up)("q-btn"),_=(0,s.up)("q-card-section"),v=(0,s.up)("q-separator"),C=(0,s.up)("q-input"),R=(0,s.up)("q-card-actions"),q=(0,s.up)("q-card"),k=(0,s.up)("q-form"),W=(0,s.up)("q-dialog"),L=(0,s.up)("q-icon"),M=(0,s.up)("vuemoji-picker"),j=(0,s.up)("q-item-section"),Q=(0,s.up)("q-list"),U=(0,s.up)("q-menu"),Z=(0,s.up)("q-toolbar-title"),J=(0,s.up)("q-toolbar"),D=(0,s.up)("q-item-label"),F=(0,s.up)("q-item"),I=(0,s.Q2)("ripple");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",l,[(0,s._)("div",r,[(0,s.Wm)($,{color:"primary",label:"방 만들기",onClick:e[0]||(e[0]=e=>o.createRoomDialog=!0),icon:"create_new_folder"})])]),(0,s.Wm)(W,{modelValue:o.createRoomDialog,"onUpdate:modelValue":e[2]||(e[2]=e=>o.createRoomDialog=e)},{default:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s.Wm)(k,{onSubmit:o.onCreateRoom,onReset:o.onCreateRoomReset},{default:(0,s.w5)((()=>[(0,s.Wm)(q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,{class:"bg-primary text-white"},{default:(0,s.w5)((()=>[d])),_:1}),(0,s.Wm)(v),(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(C,{clearable:"",filled:"",outlined:"",modelValue:o.roomTitle,"onUpdate:modelValue":e[1]||(e[1]=e=>o.roomTitle=e),label:"방 제목","lazy-rules":"",rules:[o=>o&&o.length>0||"필수입력"],"model-value":"",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},null,8,["modelValue","rules"])])),_:1}),(0,s.Wm)(R,{align:"center"},{default:(0,s.w5)((()=>[(0,s.Wm)($,{type:"reset",label:"취소",icon:"close"}),(0,s.Wm)($,{type:"submit",color:"primary",label:"확인",icon:"done"})])),_:1})])),_:1})])),_:1},8,["onSubmit","onReset"])])])),_:1},8,["modelValue"]),(0,s._)("div",c,[(0,s._)("div",m,[(0,s.Wm)(k,{ref:"chatForm",onSubmit:o.onSendMessage,onReset:o.onSendMessageReset,class:"q-gutter-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(C,{clearable:"",filled:"",outlined:"",modelValue:o.inputChatMessage,"onUpdate:modelValue":e[3]||(e[3]=e=>o.inputChatMessage=e),label:"메시지 입력",rules:[o=>o&&o.length>0||""],"lazy-rules":"","model-value":"",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},{append:(0,s.w5)((()=>[(0,s.Wm)(L,{name:"send"})])),after:(0,s.w5)((()=>[(0,s.Wm)($,{icon:"sentiment_satisfied_alt",round:"",flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{fit:""},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)(M,{onEmojiClick:o.handleEmoji},null,8,["onEmojiClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","rules"])])),_:1},8,["onSubmit","onReset"])])]),(0,s._)("div",h,[(0,s._)("div",b,[(0,s.Wm)(J,{class:"bg-secondary text-white shadow-2 q-mb-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,null,{default:(0,s.w5)((()=>[(0,s.Uk)("참가자 ("+(0,n.zw)(o.lobbyUsers.length)+")",1)])),_:1}),(0,s.Wm)($,{round:"",color:"secondary",icon:"refresh",onClick:o.refreshLobbyUsers},null,8,["onClick"])])),_:1}),o.lobbyUsers.length>0?((0,s.wg)(),(0,s.j4)(Q,{key:0,bordered:"",separator:""},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.lobbyUsers,(o=>(0,s.wy)(((0,s.wg)(),(0,s.j4)(F,{clickable:"",key:o},{default:(0,s.w5)((()=>[(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(o.username),1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[I]]))),128))])),_:1})):(0,s.kq)("",!0)]),(0,s._)("div",p,[(0,s.Wm)(J,{class:"bg-secondary text-white shadow-2 q-mb-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,null,{default:(0,s.w5)((()=>[w])),_:1})])),_:1}),o.chatMessages.length>0?((0,s.wg)(),(0,s.j4)(Q,{key:0,bordered:"",separator:""},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.chatMessages,(o=>(0,s.wy)(((0,s.wg)(),(0,s.j4)(F,{clickable:"",key:o},{default:(0,s.w5)((()=>[(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)(D,{style:(0,n.j5)({color:o.color}),class:"text-wrap"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(o.message),1)])),_:2},1032,["style"]),(0,s.Wm)(D,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)("["+(0,n.zw)(o.now)+"]",1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[I]]))),128))])),_:1})):(0,s.kq)("",!0)]),(0,s._)("div",g,[(0,s.Wm)(J,{class:"bg-orange text-white shadow-2 q-mb-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,null,{default:(0,s.w5)((()=>[(0,s.Uk)("방 목록 ("+(0,n.zw)(o.lobbyRooms.length)+")",1)])),_:1}),(0,s.Wm)($,{round:"",color:"orange",icon:"refresh",onClick:o.refreshRooms},null,8,["onClick"])])),_:1}),o.lobbyRooms.length>0?((0,s.wg)(),(0,s.j4)(Q,{key:0,bordered:"",separator:""},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.lobbyRooms,(e=>(0,s.wy)(((0,s.wg)(),(0,s.j4)(F,{clickable:"",key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.roomTitle),1)])),_:2},1024),(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)($,{color:"primary",label:"참가",onClick:t=>o.onJoinRoom(e)},null,8,["onClick"])])),_:2},1024)])),_:2},1536)),[[I]]))),128))])),_:1})):(0,s.kq)("",!0)])])])}var y=t(7108),$=t(6411);const _=(0,s.aZ)({name:"Lobby",components:{VuemojiPicker:$.k},data(){return{createRoomDialog:!1,roomTitle:"",chatMessages:[],lobbyUsers:[],lobbyRooms:[],inputChatMessage:"",joinRoom:void 0,emoji:!1}},mounted(){this.$eventBus.on("onJoinLobby",this.onJoinLobby),this.$eventBus.on("onLobbyUsers",this.onLobbyUsers),this.$eventBus.on("onLobbyChat",this.onLobbyChat),this.$eventBus.on("onLeaveLobby",this.onLeaveLobby),this.$eventBus.on("onLobbyRooms",this.onLobbyRooms),this.$eventBus.on("onDisconnected",this.onDisconnected)},methods:{handleEmoji(o){this.inputChatMessage+=o.unicode},onDisconnected(o){const e=y.QA.disconnected(o.data,o.now);this.chatMessages.push(e)},onLobbyRooms(o){this.lobbyRooms=o.data},onLeaveLobby(o){const e=y.QA.leaveMessage(o.data,o.now,y.L_.lobby);this.chatMessages.push(e)},onLobbyChat(o){const e=y.QA.chatMessage(o.data.userProfile,o.data.message,o.now);this.chatMessages.push(e)},onJoinLobby(o){const e=y.QA.joinMessage(o.data,o.now,y.L_.lobby);this.chatMessages.push(e)},onLobbyUsers(o){this.lobbyUsers=o.data},onSendMessage(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?(this.$ws.send({uri:"/lobby/chat",body:{message:this.inputChatMessage}}),void this.onSendMessageReset()):(this.$q.notify(y.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(y.FJ.lostConnection),void this.$router.push({path:"/login"}))},onSendMessageReset(){this.inputChatMessage="",this.$refs.chatForm.resetValidation()},onCreateRoom(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?(this.$router.push({path:"/room"}),setTimeout(this.lazyCreateRoom,500),void this.$q.loading.show()):(this.$q.notify(y.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(y.FJ.lostConnection),void this.$router.push({path:"/login"}))},lazyCreateRoom(){this.$ws.send({uri:"/room/create",body:{roomTitle:this.roomTitle,roomDescription:this.roomTitle}}),this.onCreateRoomReset(),this.$q.loading.hide()},onCreateRoomReset(){this.roomTitle="",this.createRoomDialog=!1},onJoinRoom(o){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?(this.joinRoom=o,this.$router.push({path:"/room"}),setTimeout(this.lazyJoinRoom,500),void this.$q.loading.show()):(this.$q.notify(y.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(y.FJ.lostConnection),void this.$router.push({path:"/login"}))},lazyJoinRoom(){this.$ws.send({uri:"/room/join",body:{roomId:this.joinRoom.roomId}}),this.joinRoom=void 0,this.$q.loading.hide()},refreshRooms(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?void this.$ws.send({uri:"/room/rooms",body:{}}):(this.$q.notify(y.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(y.FJ.lostConnection),void this.$router.push({path:"/login"}))},refreshLobbyUsers(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?void this.$ws.send({uri:"/lobby/users",body:{}}):(this.$q.notify(y.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(y.FJ.lostConnection),void this.$router.push({path:"/login"}))}}});var v=t(4260),C=t(8240),R=t(4390),q=t(8689),k=t(151),W=t(5589),L=t(5869),M=t(6805),j=t(9367),Q=t(4554),U=t(3430),Z=t(7011),J=t(2035),D=t(9570),F=t(3747),I=t(6332),z=t(2350),S=t(6489),T=t(7518),A=t.n(T);const V=(0,v.Z)(_,[["render",f],["__scopeId","data-v-a5b6a462"]]),x=V;A()(_,"components",{QBtn:C.Z,QDialog:R.Z,QForm:q.Z,QCard:k.Z,QCardSection:W.Z,QSeparator:L.Z,QInput:M.Z,QCardActions:j.Z,QIcon:Q.Z,QMenu:U.Z,QList:Z.Z,QItemSection:J.Z,QToolbar:D.Z,QToolbarTitle:F.Z,QItem:I.Z,QItemLabel:z.Z}),A()(_,"directives",{Ripple:S.Z})}}]);