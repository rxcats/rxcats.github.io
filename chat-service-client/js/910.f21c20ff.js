"use strict";(self["webpackChunkchat_service_client"]=self["webpackChunkchat_service_client"]||[]).push([[910],{7108:(e,o,s)=>{s.d(o,{QA:()=>r,L_:()=>n,FJ:()=>i});var t=s(8202);const n={lobby:"로비",room:"방"},i={notConnected:{message:"서버와 연결 중입니다. 다시 시도해 주세요.",spinner:!0,position:"top",timeout:300},lostConnection:{message:"서버와 연결이 종료되었습니다. 로그인 화면으로 이동합니다.",spinner:!0,position:"top",timeout:300},lostLoginInfo:{message:"로그인 정보가 없습니다. 로그인 화면으로 이동합니다.",spinner:!0,position:"top",timeout:300}};function a(e){return t.ou.fromISO(e).toFormat("HH:mm")}class l{joinMessage(e,o,s){return{color:"#000000",message:`${e.username}님이 ${s}에 참여했습니다.`,now:a(o)}}leaveMessage(e,o,s){return{color:"#000000",message:`${e.username}님이 ${s}에서 나갔습니다.`,now:a(o)}}chatMessage(e,o,s){return{color:e.userColor,message:`${e.username}: ${o}`,now:a(s)}}disconnected(e,o){return{color:"#000000",message:`${e.username}님의 연결이 종료되었습니다.`,now:a(o)}}}const r=new l},8910:(e,o,s)=>{s.r(o),s.d(o,{default:()=>F});var t=s(3673),n=s(2323);const i={class:"q-pa-md"},a={class:"row justify-start"},l={class:"col-all"},r={class:"row justify-start"},u={class:"col-all"},c={class:"row justify-start"},m={class:"col-3"},d=(0,t.Uk)("참가자"),h={class:"col"},p=(0,t.Uk)(" 채팅 목록 ("),w={key:0},g=(0,t.Uk)(") ");function f(e,o,s,f,v,$){const b=(0,t.up)("q-btn"),_=(0,t.up)("q-icon"),R=(0,t.up)("vuemoji-picker"),k=(0,t.up)("q-item-section"),y=(0,t.up)("q-list"),q=(0,t.up)("q-menu"),C=(0,t.up)("q-input"),M=(0,t.up)("q-form"),L=(0,t.up)("q-toolbar-title"),W=(0,t.up)("q-toolbar"),Q=(0,t.up)("q-item"),j=(0,t.up)("q-item-label"),U=(0,t.Q2)("ripple");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",a,[(0,t._)("div",l,[(0,t.Wm)(b,{color:"primary",label:"나가기",icon:"close",onClick:e.onLeaveRoomBtn},null,8,["onClick"])])]),(0,t._)("div",r,[(0,t._)("div",u,[(0,t.Wm)(M,{ref:"chatForm",onSubmit:e.onSendMessage,onReset:e.onSendMessageReset,class:"q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{clearable:"",filled:"",outlined:"",modelValue:e.inputChatMessage,"onUpdate:modelValue":o[0]||(o[0]=o=>e.inputChatMessage=o),label:"메시지 입력",rules:[e=>e&&e.length>0||""],"lazy-rules":"","model-value":"",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},{append:(0,t.w5)((()=>[(0,t.Wm)(_,{name:"send"})])),after:(0,t.w5)((()=>[(0,t.Wm)(b,{icon:"sentiment_satisfied_alt",round:"",flat:""},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{fit:""},{default:(0,t.w5)((()=>[(0,t.Wm)(y,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(R,{onEmojiClick:e.handleEmoji},null,8,["onEmojiClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","rules"])])),_:1},8,["onSubmit","onReset"])])]),(0,t._)("div",c,[(0,t._)("div",m,[(0,t.Wm)(W,{class:"bg-blue text-white shadow-2 q-mb-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(L,null,{default:(0,t.w5)((()=>[d])),_:1}),(0,t.Wm)(b,{color:"blue","icon-right":"refresh",label:"",onClick:e.refreshRoomUsers},null,8,["onClick"])])),_:1}),e.roomUsers.length>0?((0,t.wg)(),(0,t.j4)(y,{key:0,bordered:"",separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.roomUsers,(e=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:"",key:e},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.username),1)])),_:2},1024)])),_:2},1536)),[[U]]))),128))])),_:1})):(0,t.kq)("",!0)]),(0,t._)("div",h,[(0,t.Wm)(W,{class:"bg-blue text-white shadow-2 q-mb-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(L,null,{default:(0,t.w5)((()=>[p,void 0!==e.roomInfo?((0,t.wg)(),(0,t.iD)("span",w,(0,n.zw)(e.roomInfo.roomTitle),1)):(0,t.kq)("",!0),g])),_:1})])),_:1}),e.chatMessages.length>0?((0,t.wg)(),(0,t.j4)(y,{key:0,bordered:"",separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.chatMessages,(e=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:"",key:e},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(j,{style:(0,n.j5)({color:e.color}),class:"text-wrap"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.message),1)])),_:2},1032,["style"]),(0,t.Wm)(j,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)("["+(0,n.zw)(e.now)+"]",1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[U]]))),128))])),_:1})):(0,t.kq)("",!0)])])])}var v=s(7108),$=s(6411);const b=(0,t.aZ)({name:"Room",components:{VuemojiPicker:$.k},data(){return{chatMessages:[],roomUsers:[],inputChatMessage:"",roomInfo:void 0}},mounted(){this.$eventBus.on("onJoinRoom",this.onJoinRoom),this.$eventBus.on("onRoomUsers",this.onRoomUsers),this.$eventBus.on("onRoomChat",this.onRoomChat),this.$eventBus.on("onLeaveRoom",this.onLeaveRoom),this.$eventBus.on("onJoinRoomSucceeded",this.onJoinRoomSucceeded),this.$eventBus.on("onLeaveRoomSucceeded",this.onLeaveRoomSucceeded),this.$eventBus.on("onDisconnected",this.onDisconnected)},methods:{handleEmoji(e){this.inputChatMessage+=e.unicode},onDisconnected(e){const o=v.QA.disconnected(e.data,e.now);this.chatMessages.push(o)},onJoinRoomSucceeded(e){this.$ws.setAttribute("room",e.data),this.roomInfo=e.data},onLeaveRoomSucceeded(e){this.$ws.removeAttribute("room")},onSendMessage(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?(this.$ws.send({uri:"/room/chat",body:{message:this.inputChatMessage}}),void this.onSendMessageReset()):(this.$q.notify(v.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(v.FJ.lostConnection),void this.$router.push({path:"/login"}))},onSendMessageReset(){this.inputChatMessage="",this.$refs.chatForm.resetValidation()},onJoinRoom(e){const o=v.QA.joinMessage(e.data,e.now,v.L_.room);this.chatMessages.push(o)},onRoomUsers(e){this.roomUsers=e.data},onRoomChat(e){const o=v.QA.chatMessage(e.data.userProfile,e.data.message,e.now);this.chatMessages.push(o)},onLeaveRoom(e){const o=v.QA.leaveMessage(e.data,e.now,v.L_.room);this.chatMessages.push(o)},onLeaveRoomBtn(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?(this.$router.push({path:"/lobby"}),setTimeout(this.lazyLeaveRoom,500),void this.$q.loading.show()):(this.$q.notify(v.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(v.FJ.lostConnection),void this.$router.push({path:"/login"}))},lazyLeaveRoom(){this.$ws.send({uri:"/room/leave",body:{}}),this.$q.loading.hide()},refreshRoomUsers(){return this.$ws.isConnected()?this.$ws.containsAttribute("user")?void this.$ws.send({uri:"/room/users",body:{}}):(this.$q.notify(v.FJ.lostLoginInfo),void this.$router.push({path:"/login"})):(this.$q.notify(v.FJ.lostConnection),void this.$router.push({path:"/login"}))}}});var _=s(4260),R=s(8240),k=s(8689),y=s(6805),q=s(4554),C=s(3430),M=s(7011),L=s(2035),W=s(9570),Q=s(3747),j=s(6332),U=s(2350),I=s(6489),S=s(7518),Z=s.n(S);const J=(0,_.Z)(b,[["render",f],["__scopeId","data-v-b2941ae4"]]),F=J;Z()(b,"components",{QBtn:R.Z,QForm:k.Z,QInput:y.Z,QIcon:q.Z,QMenu:C.Z,QList:M.Z,QItemSection:L.Z,QToolbar:W.Z,QToolbarTitle:Q.Z,QItem:j.Z,QItemLabel:U.Z}),Z()(b,"directives",{Ripple:I.Z})}}]);